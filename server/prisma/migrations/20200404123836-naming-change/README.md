# Migration `20200404123836-naming-change`

This migration has been generated by iqpc.mobile.native at 4/4/2020, 12:38:36 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."Tag" (
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL  
) 

CREATE TABLE "quaint"."Category" (
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL  
) 

CREATE TABLE "quaint"."_TagToVoucher" (
    "A" INTEGER NOT NULL  ,
    "B" INTEGER NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Tag"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Voucher"("id") ON DELETE CASCADE ON UPDATE CASCADE
) 

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_TagsOnVouchers" (
    "tagId" INTEGER NOT NULL  ,
    "voucherId" INTEGER NOT NULL  ,
    PRIMARY KEY ("voucherId","tagId"),FOREIGN KEY ("voucherId") REFERENCES "Voucher"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("tagId") REFERENCES "Tag"("id") ON DELETE CASCADE ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_TagsOnVouchers" ("tagId", "voucherId") SELECT "tagId", "voucherId" FROM "quaint"."TagsOnVouchers"

DROP TABLE "quaint"."TagsOnVouchers";

ALTER TABLE "quaint"."new_TagsOnVouchers" RENAME TO "TagsOnVouchers";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Business" (
    "address" TEXT NOT NULL  ,
    "amount" REAL NOT NULL  ,
    "categoryId" INTEGER   ,
    "city" TEXT NOT NULL  ,
    "description" TEXT NOT NULL  ,
    "history" TEXT   ,
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "imageUrl" TEXT NOT NULL  ,
    "name" TEXT NOT NULL  ,
    "siteUrl" TEXT   ,
    "type" TEXT NOT NULL  ,FOREIGN KEY ("categoryId") REFERENCES "Category"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Business" ("address", "amount", "categoryId", "city", "description", "history", "id", "imageUrl", "name", "siteUrl", "type") SELECT "address", "amount", "categoryId", "city", "description", "history", "id", "imageUrl", "name", "siteUrl", "type" FROM "quaint"."Business"

DROP TABLE "quaint"."Business";

ALTER TABLE "quaint"."new_Business" RENAME TO "Business";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

CREATE UNIQUE INDEX "quaint"."_TagToVoucher_AB_unique" ON "_TagToVoucher"("A","B")

CREATE  INDEX "quaint"."_TagToVoucher_B_index" ON "_TagToVoucher"("B")

DROP TABLE "quaint"."VoucherTag";

DROP TABLE "quaint"."BusinessCategory";

DROP TABLE "quaint"."_VoucherToVoucherTag";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200404123254-many-to-many..20200404123836-naming-change
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "file:./dev.db"
 }
 model Voucher {
   id Int @default(autoincrement()) @id
@@ -16,26 +16,26 @@
   price Float
   promotion Float?
   businessId Int?
   business Business? @relation(fields: [businessId], references: [id])
-  tags VoucherTag[]
+  tags Tag[]
 }
 model TagsOnVouchers {
   voucher Voucher @relation(fields: [voucherId], references: [id])
   voucherId Int       
-  tag VoucherTag @relation(fields: [tagId], references: [id])
+  tag Tag @relation(fields: [tagId], references: [id])
   tagId Int
   @@id([voucherId, tagId])
 }
-model VoucherTag {
+model Tag {
   id Int @default(autoincrement()) @id
   name String
   vouchers Voucher[]
 }
-model BusinessCategory {
+model Category {
   id Int @default(autoincrement()) @id
   name String
   businesses Business[]
 }
@@ -52,8 +52,8 @@
   imageUrl String
   type String
   vouchers Voucher[]
   categoryId Int?
-  category BusinessCategory? @relation(fields: [categoryId], references: [id])
+  category Category? @relation(fields: [categoryId], references: [id])
 }
```


