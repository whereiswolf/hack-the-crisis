# Migration `20200404121620-change-relation-vouchres-business`

This migration has been generated by iqpc.mobile.native at 4/4/2020, 12:16:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "quaint"."Voucher_businessId"

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Voucher" (
    "businessId" INTEGER   ,
    "description" TEXT NOT NULL  ,
    "expirationDate" TEXT   ,
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "imageUrl" TEXT NOT NULL  ,
    "name" TEXT NOT NULL  ,
    "price" REAL NOT NULL  ,
    "promotion" REAL   ,FOREIGN KEY ("businessId") REFERENCES "Business"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Voucher" ("businessId", "description", "expirationDate", "id", "imageUrl", "name", "price", "promotion") SELECT "businessId", "description", "expirationDate", "id", "imageUrl", "name", "price", "promotion" FROM "quaint"."Voucher"

DROP TABLE "quaint"."Voucher";

ALTER TABLE "quaint"."new_Voucher" RENAME TO "Voucher";

CREATE UNIQUE INDEX "quaint"."Voucher.name" ON "Voucher"("name")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200404115123-vouchers-to-business-relation..20200404121620-change-relation-vouchres-business
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "file:./dev.db"
 }
 model Voucher {
   id Int @default(autoincrement()) @id
@@ -15,9 +15,9 @@
   imageUrl String
   price Float
   promotion Float?
   businessId Int?
-  company Voucher? @relation(fields: [businessId], references: [id])
+  company Business? @relation(fields: [businessId], references: [id])
 }
 model Business {
   id Int @default(autoincrement()) @id
```


